!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__form-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var t=class{constructor({name:e,link:t},s,o){this._name=e,this._link=t,this._handleCardClick=o,this.cardTemplate=document.querySelector(s).content.firstElementChild}getElement(){this._cardElement=this.cardTemplate.cloneNode(!0);const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return e.src=this._link,e.alt=this._name,t.textContent=this._name,this._setEventListeners(),this._cardElement}_setEventListeners(){const e=this._cardElement.querySelector(".card__like-button");this._cardElement.querySelector(".trash-button").addEventListener("click",(()=>{this._cardElement.remove()})),e.addEventListener("click",(()=>{e.classList.toggle("card__like-button_active")})),this._handleImageClick()}_handleImageClick(){this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}};class s{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}enableValidation(){this._inputs=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._setEventListeners(),this.disableSubmitButton()}_checkValidity(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)}_showInputError(e,t){e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e,t){e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}disableSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.setAttribute("disabled","disabled")}toggleSubmitButton(){this._inputs.every((e=>e.validity.valid))?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.removeAttribute("disabled")):this.disableSubmitButton()}_setEventListeners(){this._inputs.forEach((e=>{e.addEventListener("input",(e=>{this._checkValidity(e.target),this.toggleSubmitButton()}))})),this._formElement.addEventListener("submit",(e=>{e.preventDefault()}))}}class o{constructor(e){this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close-button")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target!==this._closeButton&&e.target!==this._popupElement||this.close()}))}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class r extends o{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t}close(){super.close()}_getInputValues(){const e={};return Array.from(this._popupForm.querySelectorAll(".modal__form-input")).forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this._popupForm.reset(),this.close()}))}}const n=document.querySelector("#profile-edit-button"),i=(document.querySelector("#edit-close-button"),document.querySelector("#edit-modal"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input"),document.querySelector("#profile-description-input"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".template"),document.forms["profile-form"]),l=document.querySelector("#add-card-form"),a=(document.querySelector(".cards__list"),document.querySelector(".profile__add-button")),c=(document.querySelector("#add-modal"),l.querySelector("#modal-add-input-title"),l.querySelector("#modal-add-input-url"),document.querySelector("#image-preview-modal"),document.querySelector(".modal__image"),document.querySelector(".modal__image-description"),document.querySelectorAll(".modal__close-button"),document.querySelector(".modal__container--preview"),new s(e,i)),u=new s(e,l),d=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._containerSelector=s}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){document.querySelector(this._containerSelector).prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake House",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago de Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=E(e);d.addItem(t)}},".cards__list"),m=new class extends o{constructor(e){super(e),this._image=this._popupElement.querySelector(".modal__image"),this._caption=this._popupElement.querySelector(".modal__image-description")}open(e){this._image.src=e.link,this._image.alt=e.name,this._caption.textContent=e.name,super.open()}}("#image-preview-modal");m.setEventListeners();const _=new r("#add-modal",(e=>{const t=E(e);d.addItem(t)})),p=new class{constructor({title:e,description:t}){this._title=document.querySelector(e),this._description=document.querySelector(t),this._closeBtn=document.querySelector("#edit-close-button")}getUserInfo(){return{title:this._title.textContent,description:this._description.textContent}}setUserInfo(e){this._title.textContent=e.title,this._description.textContent=e.description}}({title:".profile__title",description:".profile__description"}),h=new r("#edit-modal",(e=>{p.setUserInfo(e)}));h.setEventListeners();const E=e=>new t(e,"#card-template",S).getElement();function S(e){m.open(e)}d.renderItems(),c.enableValidation(),u.enableValidation(),_.setEventListeners(),m.setEventListeners(),a.addEventListener("click",(()=>{_.open()})),n.addEventListener("click",(()=>{h.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YyxJRy9ETCxNQUNiaEgsV0FBQUEsRUFBWSxNQUFFaUgsRUFBSyxZQUFFQyxJQUNuQjdHLEtBQUs4RyxPQUFTekcsU0FBU0MsY0FBY3NHLEdBQ3JDNUcsS0FBSytHLGFBQWUxRyxTQUFTQyxjQUFjdUcsR0FDM0M3RyxLQUFLZ0gsVUFBWTNHLFNBQVNDLGNBQWMscUJBQzFDLENBRUEyRyxXQUFBQSxHQUtFLE1BSm1CLENBQ2pCTCxNQUFPNUcsS0FBSzhHLE9BQU85RixZQUNuQjZGLFlBQWE3RyxLQUFLK0csYUFBYS9GLFlBR25DLENBRUFrRyxXQUFBQSxDQUFZQyxHQUNWbkgsS0FBSzhHLE9BQU85RixZQUFjbUcsRUFBU1AsTUFDbkM1RyxLQUFLK0csYUFBYS9GLFlBQWNtRyxFQUFTTixXQUMzQyxHSDZDK0IsQ0FDL0JELE1BQU8sa0JBQ1BDLFlBQWEsMEJBR1RPLEVBQWUsSUFBSTlDLEVBQWMsZUFBZ0JRLElBQ3JENkIsRUFBWU8sWUFBWXBDLEVBQVMsSUFFbkNzQyxFQUFhaEQsb0JBRWIsTUFBTWlDLEVBQWNJLEdBQ1gsSUFBSVksRUFBS1osRUFBTSxpQkFBa0IxRyxHQUFpQlUsYUFZM0QsU0FBU1YsRUFBZ0JvRyxHQUN2QkcsRUFBZXRDLEtBQUttQyxFQUN0QixDQVJBWixFQUFRTyxjQUNSVCxFQUFxQm5ELG1CQUNyQm9ELEVBQXFCcEQsbUJBQ3JCd0UsRUFBYXRDLG9CQUNia0MsRUFBZWxDLG9CQVVmZ0IsRUFBVWpFLGlCQUFpQixTQUFTLEtBQ2xDdUYsRUFBYTFDLE1BQU0sSUFHckJnQixFQUFrQjdELGlCQUFpQixTQUFTLEtBQzFDaUcsRUFBYXBELE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi91dGlsL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3NjcmlwdHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9zY3JpcHRzL2luZGV4LmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3NjcmlwdHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIEhvdXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkZSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2Zvcm0taW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuIiwiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rIH0sIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2spIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLmNhcmRUZW1wbGF0ZSA9XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFRlbXBsYXRlU2VsZWN0b3IpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgfVxyXG5cclxuICBnZXRFbGVtZW50KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLmNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICBjb25zdCBjYXJkSW1hZ2VFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjb25zdCBjYXJkVGl0bGVFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcblxyXG4gICAgY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcclxuICAgIGNhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICBjYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGNhcmRMaWtlQnV0dG9uID1cclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50cmFzaC1idXR0b25cIik7XHJcblxyXG4gICAgdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYXJkTGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljaygpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUltYWdlQ2xpY2soKSB7XHJcbiAgICBjb25zdCBjYXJkSW1hZ2VFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIC8vIFNlbGVjdCBhbGwgaW5wdXQgZmllbGRzIHdpdGhpbiB0aGUgZm9ybVxyXG4gICAgdGhpcy5faW5wdXRzID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIC8vIFNlbGVjdCB0aGUgc3VibWl0IGJ1dHRvblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcblxyXG4gICAgLy8gU2V0IGV2ZW50IGxpc3RlbmVycyBvbiBlYWNoIGlucHV0IGVsZW1lbnRcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLmRpc2FibGVTdWJtaXRCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIF9jaGVja1ZhbGlkaXR5KGlucHV0KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIGNvbnN0IGlzVmFsaWQgPSBpbnB1dC52YWxpZGl0eS52YWxpZDtcclxuXHJcbiAgICBpZiAoIWlzVmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQsIGVycm9yRWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCwgZXJyb3JFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dCwgZXJyb3JFbGVtZW50KSB7XHJcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0LCBlcnJvckVsZW1lbnQpIHtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcImRpc2FibGVkXCIpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgY29uc3QgaXNGb3JtVmFsaWQgPSB0aGlzLl9pbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbiAgICBpZiAoaXNGb3JtVmFsaWQpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gTG9vcCB0aHJvdWdoIGVhY2ggaW5wdXQgYW5kIHNldCB0aGUgZXZlbnQgbGlzdGVuZXJcclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tWYWxpZGl0eShldmVudC50YXJnZXQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlU3VibWl0QnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUHJldmVudCBmb3JtIHN1Ym1pc3Npb24gZm9yIHRlc3Rpbmcgb3IgYWRkaXRpb25hbCBiZWhhdmlvciAob3B0aW9uYWwpXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxyXG4gICAgKTtcclxuICB9XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZlbnQudGFyZ2V0ID09PSB0aGlzLl9jbG9zZUJ1dHRvbiB8fFxyXG4gICAgICAgIGV2ZW50LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50XHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAvL0l0IGFjY2VwdHMgdHdvIGFyZ3VtZW50czogdGhlIHBvcHVwIHNlbGVjdG9yIGFuZCBhIGNhbGxiYWNrIGZ1bmN0aW9uLFxyXG4gICAgLy93aGljaCBQb3B1cFdpdGhGb3JtIGNhbGxzIHdoZW4gdGhlIGZvcm1zIHN1Ym1pdCBldmVudCBmaXJlcy5cclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybS1pbnB1dFwiKVxyXG4gICAgKTtcclxuICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcblxyXG4gICAgLy93aGljaCBjb2xsZWN0cyBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHMgYW5kIHJldHVybnMgaXQgYXMgYW4gb2JqZWN0LlxyXG4gICAgLy9UaGlzIGRhdGEgc2hvdWxkIHRoZW4gYmUgcGFzc2VkIHRvIHRoZSBzdWJtaXNzaW9uIGhhbmRsZXIgYXMgYW4gYXJndW1lbnQuXHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgZm9ybURhdGEgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGZvcm1EYXRhKTtcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgLy9UaGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBtZXRob2Qgb2YgdGhlIFBvcHVwV2l0aEZvcm0gY2xhc3Mgc2hvdWxkIGFkZCBhIHN1Ym1pdFxyXG4gICAgLy8gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGZvcm0gYW5kIGNhbGwgdGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kIG9mIHRoZSBwYXJlbnQgY2xhc3MuXHJcbiAgfVxyXG59XHJcblxyXG4vL0NyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgUG9wdXBXaXRoRm9ybSBjbGFzcyBmb3IgZWFjaCBwb3B1cCB0aGF0IGNvbnRhaW5zIGEgZm9ybSxcclxuLy8gYW5kIGNhbGwgdGhlaXIgc2V0RXZlbnRMaXN0ZW5lcnMoKSBtZXRob2QuXHJcbiIsImltcG9ydCB7IGluaXRpYWxDYXJkcywgdmFsaWRhdGlvblNldHRpbmdzIH0gZnJvbSBcIi4uLy4uL3V0aWwvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4vUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4vUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4vU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vVXNlckluZm8uanNcIjtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWNsb3NlLWJ1dHRvblwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZUNsYXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50ZW1wbGF0ZVwiKTtcclxuY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXTtcclxuY29uc3QgYWRkTW9kYWxGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xyXG5jb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBhZGRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLW1vZGFsXCIpO1xyXG5cclxuY29uc3QgYWRkTW9kYWxUaXRsZSA9IGFkZE1vZGFsRm9ybS5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWFkZC1pbnB1dC10aXRsZVwiKTtcclxuY29uc3QgYWRkTW9kYWxVcmwgPSBhZGRNb2RhbEZvcm0ucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1hZGQtaW5wdXQtdXJsXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuY29uc3QgbW9kYWxJbWFnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2NvbnRhaW5lci0tcHJldmlld1wiXHJcbik7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgcHJvZmlsZUZvcm0pO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXHJcbiAgYWRkTW9kYWxGb3JtXHJcbik7XHJcblxyXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcclxuICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1wcmV2aWV3LW1vZGFsXCIpO1xyXG5cclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgYWRkQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLW1vZGFsXCIsIChmb3JtRGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGZvcm1EYXRhKTtcclxuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XHJcbn0pO1xyXG5cclxuY29uc3QgcHJvZmlsZUluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIHRpdGxlOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGRlc2NyaXB0aW9uOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG59KTtcclxuXHJcbmNvbnN0IHByb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2VkaXQtbW9kYWxcIiwgKGZvcm1EYXRhKSA9PiB7XHJcbiAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oZm9ybURhdGEpO1xyXG59KTtcclxucHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICByZXR1cm4gbmV3IENhcmQoZGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCBoYW5kbGVDYXJkQ2xpY2spLmdldEVsZW1lbnQoKTtcclxufTtcclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbnNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZENhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGNhcmREYXRhKSB7XHJcbiAgcG9wdXBXaXRoSW1hZ2Uub3BlbihjYXJkRGF0YSk7XHJcbn1cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50IExpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVNb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXJTZWxlY3RvciA9IGNvbnRhaW5lclNlbGVjdG9yO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29udGFpbmVyU2VsZWN0b3IpLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9faW1hZ2UtZGVzY3JpcHRpb25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IHRpdGxlLCBkZXNjcmlwdGlvbiB9KSB7XHJcbiAgICB0aGlzLl90aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGl0bGUpO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uKTtcclxuICAgIHRoaXMuX2Nsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWNsb3NlLWJ1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3Qgb2JqZWN0SW5mbyA9IHtcclxuICAgICAgdGl0bGU6IHRoaXMuX3RpdGxlLnRleHRDb250ZW50LFxyXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIG9iamVjdEluZm87XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh1c2VyRGF0YSkge1xyXG4gICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS50aXRsZTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRhdGEuZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImNvbnN0cnVjdG9yIiwibmFtZSIsImxpbmsiLCJjYXJkVGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2hhbmRsZUNhcmRDbGljayIsImNhcmRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImdldEVsZW1lbnQiLCJfY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJjYXJkSW1hZ2VFbCIsImNhcmRUaXRsZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJjYXJkTGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfaGFuZGxlSW1hZ2VDbGljayIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwiX2lucHV0cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsIl9jaGVja1ZhbGlkaXR5IiwiaW5wdXQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNldEF0dHJpYnV0ZSIsInRvZ2dsZVN1Ym1pdEJ1dHRvbiIsImV2ZXJ5IiwicmVtb3ZlQXR0cmlidXRlIiwiZm9yRWFjaCIsImV2ZW50IiwidGFyZ2V0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsImtleSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwiZm9ybURhdGEiLCJyZXNldCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsImFkZE1vZGFsRm9ybSIsImFkZEJ1dHRvbiIsInByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJzZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZERhdGEiLCJjYXJkIiwiY3JlYXRlQ2FyZCIsInBvcHVwV2l0aEltYWdlIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJkYXRhIiwiYWRkQ2FyZE1vZGFsIiwicHJvZmlsZUluZm8iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiX3RpdGxlIiwiX2Rlc2NyaXB0aW9uIiwiX2Nsb3NlQnRuIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsInVzZXJEYXRhIiwicHJvZmlsZU1vZGFsIiwiQ2FyZCJdLCJzb3VyY2VSb290IjoiIn0=